<!doctype html>
<html lang="en" class="min-h-full bg-gray-100 dark:bg-gray-900">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TaskTrack Pomodoro</title>
    <meta name="theme-color" content="#111827" />
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="icon" href="assets/icons/app-logo.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" sizes="180x180" href="assets/icons/icon-192.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="assets/icons/icon-192.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="assets/icons/icon-192.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="assets/icons/icon-192.png" />

    <!-- Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Font Awesome for icons -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      rel="stylesheet"
    />

    <!-- App styles -->
    <link rel="stylesheet" href="assets/styles.css" />
  </head>

  <body
    class="min-h-screen flex flex-col md:flex-row bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200"
    style="min-height: 100vh; min-height: 100dvh;"
  >
    <!-- SVG sprite: app logo + small icons -->
    <svg
      aria-hidden="true"
      width="0"
      height="0"
      style="position: absolute"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
    >
      <defs>
        <linearGradient id="app-logo-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#34d399"></stop>
          <stop offset="100%" stop-color="#60a5fa"></stop>
        </linearGradient>
        <symbol id="app-logo" viewBox="0 0 64 64">
          <g fill="none" stroke="url(#app-logo-gradient)" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="32" cy="32" r="22" stroke-width="4" />
            <circle cx="32" cy="32" r="28" stroke-width="2" stroke-dasharray="6 6" opacity="0.7" />
            <path d="M24 8h16" stroke-width="3" />
            <path d="M32 14v6" stroke-width="3" />
            <path d="M40 4H24" stroke-width="3" />
            <path d="M32 20l-6 10" stroke-width="4" />
            <circle cx="32" cy="32" r="3" fill="url(#app-logo-gradient)" stroke="none" />
          </g>
        </symbol>
      </defs>
    </svg>

    <!-- Mobile Header -->
    <div
      id="mobileHeader"
      class="md:hidden flex items-center justify-start gap-4 p-4 bg-white dark:bg-gray-800 shadow-md"
    >
      <button id="menu-toggle" class="text-gray-900 dark:text-gray-100">
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16m-7 6h7"
          />
        </svg>
      </button>
      <div class="flex items-center">
        <svg class="nav-logo nav-logo--mobile mr-2 text-gray-800 dark:text-white">
          <use href="#app-logo" xlink:href="#app-logo" />
        </svg>
        <h1 class="text-xl font-bold text-gray-900 dark:text-gray-100">
          TaskTrack Pomodoro
        </h1>
      </div>
    </div>

    <!-- Sidebar -->
    <div
      id="sidebar"
      class="fixed inset-y-0 left-0 w-64 bg-white dark:bg-gray-800 p-6 flex flex-col items-center shadow-lg border-r border-gray-200 dark:border-gray-700 overflow-y-auto md:overflow-visible transform -translate-x-full md:relative md:translate-x-0 transition-transform duration-300 ease-in-out z-40 md:min-h-screen"
      style="min-height: 100vh; min-height: 100dvh;"
    >
      <div class="mb-8 w-full">
        <button
          id="brandHome"
          class="flex flex-col items-center w-full cursor-pointer pt-6"
        >
          <svg
            id="brandLogo"
            class="nav-logo text-gray-800 dark:text-white mb-1 -mt-8"
          >
            <use href="#app-logo" xlink:href="#app-logo" />
          </svg>
          <h1
            id="brandTitle"
            class="text-2xl leading-none font-bold text-center text-gray-900 dark:text-gray-100"
          >
            TaskTrack Pomodoro
          </h1>
        </button>
      </div>

      <div class="mb-8">
        <label class="dark-mode-toggle">
          <span class="mr-3 font-semibold text-gray-500 dark:text-gray-400">Dark Mode</span>
          <input type="checkbox" id="themeToggle" class="peer" />
          <span class="toggle-track"><span class="toggle-thumb"></span></span>
        </label>
      </div>

      <nav class="w-full">
        <button class="nav-btn active-nav-button" data-target="today">
          <span class="flex items-center">
            <i class="fa-solid fa-check-double h-5 w-5 mr-3"></i>
            Today
          </span>
        </button>
        <button class="nav-btn" data-target="week">
          <span class="flex items-center">
            <i class="fa-solid fa-calendar-week h-5 w-5 mr-3"></i>
            This Week
          </span>
        </button>
        <button class="nav-btn" data-target="settings">
          <span class="flex items-center">
            <i class="fa-solid fa-sliders-h h-5 w-5 mr-3"></i>
            Settings
          </span>
        </button>
      </nav>
    </div>

    <div
      id="overlay"
      class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden md:hidden"
    ></div>

    <main class="flex-1 p-4 md:p-8 overflow-y-auto md:overflow-y-visible overflow-x-hidden">
      <div id="today" class="content-section active">
        <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
          <div>
            <p class="text-sm uppercase tracking-wide text-gray-500 dark:text-gray-400">Daily plan</p>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-gray-100">Today</h2>
            <p class="text-gray-700 dark:text-gray-300 mt-2">
              Plan tasks, focus with pomodoros, and track progress for the current day.
            </p>
          </div>
          <div class="guidance-card max-w-md" data-first-time>
            <p class="font-semibold text-gray-900 dark:text-gray-100">Active task</p>
            <p id="activeTaskBadge" class="text-sm text-gray-700 dark:text-gray-300">
              No task selected yet.
            </p>
          </div>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mt-6">
          <div class="card">
            <div class="flex flex-wrap items-center justify-between gap-3 mb-4">
              <div class="flex gap-2" role="group" aria-label="Timer mode">
                <button class="btn btn-ghost" data-timer-mode="focus">Focus</button>
                <button class="btn btn-ghost" data-timer-mode="short">Short Break</button>
                <button class="btn btn-ghost" data-timer-mode="long">Long Break</button>
              </div>
              <p id="timerStatus" class="text-sm text-gray-600 dark:text-gray-300">
                Focus for 25:00
              </p>
            </div>
            <div class="flex flex-col gap-6 md:flex-row md:items-center">
              <div class="flex-1 text-center space-y-2">
                <p class="text-sm text-gray-500 dark:text-gray-400">Current session</p>
                <p id="timerDisplay" class="text-6xl font-black tracking-tight">25:00</p>
                <p id="timerActiveTask" class="text-sm text-gray-600 dark:text-gray-300">
                  No active task selected
                </p>
              </div>
              <div class="md:w-56 space-y-2">
                <button id="startPauseTimer" class="btn btn-blue w-full">Start Focus</button>
                <button id="resetTimer" class="btn btn-gray w-full">Reset</button>
              </div>
            </div>
            <p id="timerWarning" class="mt-4 text-sm text-amber-600 dark:text-amber-400 hidden">
              Select an active task so completed pomodoros are recorded.
            </p>
          </div>

          <div class="card">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4">
              Add or edit today's tasks
            </h3>
            <form id="taskForm" class="space-y-4">
              <div>
                <label class="form-label" for="taskTitle">Title</label>
                <input id="taskTitle" name="title" class="input-field" type="text" required />
              </div>
              <div>
                <label class="form-label" for="taskDescription">Description (optional)</label>
                <textarea id="taskDescription" name="description" class="input-field" rows="2"></textarea>
              </div>
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div>
                  <label class="form-label" for="taskPlanned">Planned pomodoros</label>
                  <input id="taskPlanned" name="planned" class="input-field" type="number" min="0" value="1" />
                </div>
                <div>
                  <label class="form-label" for="taskCompleted">Completed pomodoros</label>
                  <input
                    id="taskCompleted"
                    name="completed"
                    class="input-field"
                    type="number"
                    min="0"
                    value="0"
                  />
                </div>
              </div>
              <div class="flex flex-wrap gap-3">
                <button id="saveTask" class="btn btn-blue" type="submit">Add Task</button>
                <button id="cancelEdit" class="btn btn-gray hidden" type="button">Cancel edit</button>
              </div>
            </form>
          </div>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mt-6">
          <div class="card">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Today's tasks</h3>
              <p id="todayDateLabel" class="text-sm text-gray-600 dark:text-gray-300"></p>
            </div>
            <div id="taskList" class="space-y-3"></div>
            <p id="taskListEmpty" class="text-sm text-gray-600 dark:text-gray-400">No tasks yet. Add your first focus item.</p>
          </div>

          <div class="card">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Today summary</h3>
              <span id="todayTotals" class="text-sm text-gray-600 dark:text-gray-300"></span>
            </div>
            <div id="todaySummary" class="space-y-2"></div>
            <p id="todaySummaryEmpty" class="text-sm text-gray-600 dark:text-gray-400">Tasks you add will appear here with planned and completed pomodoros.</p>
          </div>
        </div>
      </div>

      <div id="week" class="content-section">
        <div class="flex flex-col gap-2 mb-6">
          <p class="text-sm uppercase tracking-wide text-gray-500 dark:text-gray-400">Weekly overview</p>
          <h2 class="text-3xl font-bold text-gray-900 dark:text-gray-100">This week</h2>
          <p class="text-gray-700 dark:text-gray-300">
            Review the last seven days to see how planned and completed pomodoros add up.
          </p>
        </div>
        <div class="card">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Daily totals</h3>
            <p class="text-sm text-gray-600 dark:text-gray-300">Planned vs completed pomodoros</p>
          </div>
          <div id="weekSummary" class="divide-y divide-gray-200 dark:divide-gray-700"></div>
          <p id="weekSummaryEmpty" class="text-sm text-gray-600 dark:text-gray-400">
            Add tasks to see your daily pomodoro totals.
          </p>
        </div>
      </div>

      <div id="settings" class="content-section">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6">Settings</h2>
        <div class="card is-collapsible" data-collapsible data-collapsible-id="settings-version">
          <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">
            <button
              type="button"
              class="card-toggle"
              data-collapsible-trigger
              aria-expanded="true"
              aria-controls="settings-version-content"
            >
              <span>Version</span>
              <svg
                class="chev"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                aria-hidden="true"
              >
                <path
                  d="M6 8l4 4 4-4"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </h3>
          <div
            id="settings-version-content"
            class="card-body space-y-4"
            data-collapsible-content
          >
            <p class="text-sm text-gray-700 dark:text-gray-300">
              TaskTrack Pomodoro version
              <span
                data-app-version
                class="font-semibold text-gray-900 dark:text-gray-100"
                >dev</span
              >
            </p>
            <div class="flex flex-col gap-3 sm:items-start">
              <button
                class="btn btn-blue w-full sm:w-auto"
                data-action="update-app"
                type="button"
              >
                Check for updates
              </button>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                Installs the latest version without clearing your saved preferences.
              </p>
            </div>
          </div>
        </div>

        <div class="card is-collapsible" data-collapsible data-collapsible-id="settings-layout">
          <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">
            <button
              type="button"
              class="card-toggle"
              data-collapsible-trigger
              aria-expanded="true"
              aria-controls="settings-layout-content"
            >
              <span>Layout Settings</span>
              <svg
                class="chev"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                aria-hidden="true"
              >
                <path
                  d="M6 8l4 4 4-4"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </h3>
          <div
            id="settings-layout-content"
            class="card-body space-y-6"
            data-collapsible-content
          >
            <div>
              <p class="text-gray-700 dark:text-gray-300 text-sm mb-4">
                Choose a look and feel. Your choice is saved for the next visit.
              </p>
              <div class="max-w-xs">
                <label for="themeSelect" class="form-label">Theme</label>
                <select id="themeSelect" class="input-field">
                  <option value="default">Default</option>
                  <option value="inverted">Inverted</option>
                  <option value="glass">Glass</option>
                </select>
              </div>
            </div>
            <div>
              <p class="text-gray-700 dark:text-gray-300 text-sm mb-4">
                Decide whether the navigation menu stays fixed at the top while scrolling on mobile devices.
              </p>
              <label class="dark-mode-toggle">
                <span class="mr-3 font-semibold text-gray-500 dark:text-gray-400"
                  >Keep navigation menu fixed on mobile</span
                >
                <input
                  type="checkbox"
                  id="mobileNavStickyToggle"
                  class="peer"
                  checked
                />
                <span class="toggle-track"><span class="toggle-thumb"></span></span>
              </label>
            </div>
            <div>
              <p class="text-gray-700 dark:text-gray-300 text-sm mb-4">
                Hide quick-start guidance once you are comfortable with the app.
              </p>
              <label class="dark-mode-toggle">
                <span class="mr-3 font-semibold text-gray-500 dark:text-gray-400">Show helper tips</span>
                <input type="checkbox" id="welcomeToggle" class="peer" checked />
                <span class="toggle-track"><span class="toggle-thumb"></span></span>
              </label>
            </div>
          </div>
        </div>

        <div class="card is-collapsible" data-collapsible data-collapsible-id="settings-reset">
          <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">
            <button
              type="button"
              class="card-toggle"
              data-collapsible-trigger
              aria-expanded="true"
              aria-controls="settings-reset-content"
            >
              <span>Reset App</span>
              <svg
                class="chev"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                aria-hidden="true"
              >
                <path
                  d="M6 8l4 4 4-4"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </h3>
          <div
            id="settings-reset-content"
            class="card-body space-y-4"
            data-collapsible-content
          >
            <p class="text-gray-700 dark:text-gray-300 text-sm">
              Clear TaskTrack Pomodoro data stored on this device.
            </p>
            <button class="btn btn-red flex items-center" data-action="clear-data">
              <i class="fa-solid fa-trash mr-2"></i>
              Clear Data
            </button>
          </div>
        </div>

        <div
          id="changelogCard"
          class="card is-collapsible"
          data-collapsible
          data-collapsible-id="settings-changelog"
        >
          <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">
            <button
              type="button"
              class="card-toggle"
              data-collapsible-trigger
              aria-expanded="true"
              aria-controls="settings-changelog-content"
            >
              <span>Changelog</span>
              <svg
                class="chev"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                aria-hidden="true"
              >
                <path
                  d="M6 8l4 4 4-4"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </h3>
          <div
            id="settings-changelog-content"
            class="card-body space-y-4"
            data-collapsible-content
          >
            <p class="text-sm text-gray-700 dark:text-gray-300">
              The most recent TaskTrack Pomodoro updates appear here.
            </p>
            <div data-changelog-list class="space-y-4"></div>
            <p
              data-changelog-empty
              class="text-sm text-gray-500 dark:text-gray-400 hidden"
            >
              Recent release notes will appear here after the next update.
            </p>
            <p
              data-changelog-error
              class="text-sm text-red-600 dark:text-red-400 hidden"
            >
              We couldn't load the changelog. Please check your connection and try again.
            </p>
          </div>
        </div>
      </div>
    </main>

    <div
      id="modal"
      class="modal-overlay modal-hidden"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
    >
      <div class="modal-panel">
        <button
          type="button"
          class="btn-icon absolute top-3 right-3 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300"
          data-action="close-modal"
          aria-label="Close dialog"
        >
          <span class="sr-only">Close</span>
          <i class="fa-solid fa-xmark text-lg" aria-hidden="true"></i>
        </button>
        <div id="modal-body" class="space-y-4"></div>
      </div>
    </div>

    <script src="assets/js/app.js"></script>
  </body>
</html>
